<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” CORSé”™è¯¯å¯è§†åŒ–æ¼”ç¤º</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            line-height: 1.6;
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }
        .step {
            background: #f8f9fa;
            border-left: 5px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            position: relative;
        }
        .step.error {
            border-left-color: #dc3545;
            background: #f8d7da;
        }
        .step.success {
            border-left-color: #28a745;
            background: #d4edda;
        }
        .arrow {
            font-size: 24px;
            text-align: center;
            margin: 10px 0;
            color: #007bff;
        }
        .code {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 10px 0;
        }
        .highlight {
            background: #ffeaa7;
            padding: 2px 5px;
            border-radius: 3px;
            color: #2d3436;
            font-weight: bold;
        }
        .demo-section {
            margin: 30px 0;
        }
        .url-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .url-box {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .same-origin {
            background: #d4edda;
            border: 2px solid #28a745;
        }
        .cross-origin {
            background: #f8d7da;
            border: 2px solid #dc3545;
        }
        .flow-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .flow-item {
            flex: 1;
            text-align: center;
            padding: 10px;
            margin: 5px;
            border-radius: 8px;
            min-width: 150px;
        }
        .browser {
            background: #e3f2fd;
            border: 2px solid #2196f3;
        }
        .server {
            background: #f3e5f5;
            border: 2px solid #9c27b0;
        }
        .blocked {
            background: #ffebee;
            border: 2px solid #f44336;
        }
        .allowed {
            background: #e8f5e8;
            border: 2px solid #4caf50;
        }
        .interactive-demo {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover {
            background: #0056b3;
        }
        .error-btn {
            background: #dc3545;
        }
        .success-btn {
            background: #28a745;
        }
        #demoResult {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            min-height: 50px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” CORSé”™è¯¯å¯è§†åŒ–æ¼”ç¤º</h1>
        <p>é€šè¿‡å¯è§†åŒ–çš„æ–¹å¼ç†è§£CORSé”™è¯¯çš„å®Œæ•´è¿‡ç¨‹</p>
    </div>

    <div class="container">
        <h2>ğŸ“š ä»€ä¹ˆæ˜¯åŒæºå’Œè·¨åŸŸï¼Ÿ</h2>
        
        <div class="url-comparison">
            <div class="url-box same-origin">
                <h3>âœ… åŒæºï¼ˆå…è®¸ï¼‰</h3>
                <div class="code">
                    å½“å‰é¡µé¢: https://example.com<br>
                    è¯·æ±‚ç›®æ ‡: https://example.com/api
                </div>
                <p>åè®®ã€åŸŸåã€ç«¯å£éƒ½ç›¸åŒ</p>
            </div>
            
            <div class="url-box cross-origin">
                <h3>âŒ è·¨åŸŸï¼ˆéœ€è¦CORSï¼‰</h3>
                <div class="code">
                    å½“å‰é¡µé¢: https://frontend.vercel.app<br>
                    è¯·æ±‚ç›®æ ‡: https://backend.vercel.app/api
                </div>
                <p>åŸŸåä¸åŒï¼Œéœ€è¦CORSé…ç½®</p>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ”„ CORSé”™è¯¯çš„å®Œæ•´è¿‡ç¨‹</h2>
        
        <div class="step">
            <h3>ç¬¬1æ­¥ï¼šå‰ç«¯å‘èµ·è¯·æ±‚</h3>
            <div class="code">
fetch('https://ai-bookworm-backend.vercel.app/health')
  .then(response => response.json())
  .then(data => console.log(data));
            </div>
        </div>

        <div class="arrow">â¬‡ï¸</div>

        <div class="step">
            <h3>ç¬¬2æ­¥ï¼šæµè§ˆå™¨æ£€æŸ¥è·¨åŸŸ</h3>
            <p>æµè§ˆå™¨å‘ç°ï¼š</p>
            <ul>
                <li>å½“å‰é¡µé¢ï¼š<span class="highlight">ai-bookworm-frontend2.vercel.app</span></li>
                <li>ç›®æ ‡APIï¼š<span class="highlight">ai-bookworm-backend.vercel.app</span></li>
                <li>ç»“è®ºï¼š<span class="highlight">è·¨åŸŸï¼éœ€è¦CORSæ£€æŸ¥</span></li>
            </ul>
        </div>

        <div class="arrow">â¬‡ï¸</div>

        <div class="step">
            <h3>ç¬¬3æ­¥ï¼šå‘é€é¢„æ£€è¯·æ±‚ï¼ˆOPTIONSï¼‰</h3>
            <div class="code">
OPTIONS /health HTTP/1.1
Host: ai-bookworm-backend.vercel.app
Origin: https://ai-bookworm-frontend2.vercel.app
Access-Control-Request-Method: GET
            </div>
            <p>æµè§ˆå™¨è‡ªåŠ¨å‘é€è¯¢é—®ï¼š"æˆ‘å¯ä»¥ä»frontend2è®¿é—®backendå—ï¼Ÿ"</p>
        </div>

        <div class="arrow">â¬‡ï¸</div>

        <div class="step success">
            <h3>ç¬¬4aæ­¥ï¼šæœåŠ¡å™¨æ­£ç¡®å“åº”ï¼ˆâœ… æˆåŠŸæƒ…å†µï¼‰</h3>
            <div class="code">
HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://ai-bookworm-frontend2.vercel.app
Access-Control-Allow-Methods: GET, POST, PUT, DELETE
Access-Control-Allow-Headers: Content-Type, Authorization
            </div>
            <p>æœåŠ¡å™¨è¯´ï¼š"âœ… å…è®¸ï¼ä½ å¯ä»¥è®¿é—®æˆ‘çš„API"</p>
        </div>

        <div class="step error">
            <h3>ç¬¬4bæ­¥ï¼šæœåŠ¡å™¨é”™è¯¯å“åº”ï¼ˆâŒ å¤±è´¥æƒ…å†µï¼‰</h3>
            <div class="code">
HTTP/1.1 200 OK
Content-Type: application/json
(æ²¡æœ‰CORSå¤´éƒ¨)
            </div>
            <p>æœåŠ¡å™¨è¯´ï¼š"âŒ æˆ‘ä¸çŸ¥é“ä»€ä¹ˆæ˜¯CORSï¼Œæˆ‘ä¸å…è®¸è·¨åŸŸ"</p>
        </div>

        <div class="arrow">â¬‡ï¸</div>

        <div class="step success">
            <h3>ç¬¬5aæ­¥ï¼šæµè§ˆå™¨å…è®¸è¯·æ±‚ï¼ˆâœ… æˆåŠŸæƒ…å†µï¼‰</h3>
            <p>æµè§ˆå™¨ï¼š"å¥½çš„ï¼ŒæœåŠ¡å™¨å…è®¸äº†ï¼Œæˆ‘å¯ä»¥å‘é€å®é™…çš„APIè¯·æ±‚"</p>
            <div class="code">
GET /health HTTP/1.1
Host: ai-bookworm-backend.vercel.app
Origin: https://ai-bookworm-frontend2.vercel.app
            </div>
        </div>

        <div class="step error">
            <h3>ç¬¬5bæ­¥ï¼šæµè§ˆå™¨é˜»æ­¢è¯·æ±‚ï¼ˆâŒ å¤±è´¥æƒ…å†µï¼‰</h3>
            <p>æµè§ˆå™¨ï¼š"æœåŠ¡å™¨æ²¡æœ‰æ˜ç¡®å…è®¸ï¼Œä¸ºäº†å®‰å…¨ï¼Œæˆ‘æ‹’ç»è¿™ä¸ªè¯·æ±‚"</p>
            <div class="code">
Console Error:
Access to fetch at 'https://ai-bookworm-backend.vercel.app/health' 
from origin 'https://ai-bookworm-frontend2.vercel.app' 
has been blocked by CORS policy
            </div>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ”„ è¯·æ±‚æµç¨‹å¯è§†åŒ–</h2>
        
        <div class="flow-container">
            <div class="flow-item browser">
                <strong>ğŸŒ æµè§ˆå™¨</strong><br>
                æ£€æŸ¥è·¨åŸŸ
            </div>
            <div style="font-size: 24px;">â¡ï¸</div>
            <div class="flow-item server">
                <strong>ğŸ” é¢„æ£€è¯·æ±‚</strong><br>
                OPTIONS /health
            </div>
            <div style="font-size: 24px;">â¡ï¸</div>
            <div class="flow-item server">
                <strong>ğŸ–¥ï¸ åç«¯æœåŠ¡å™¨</strong><br>
                æ£€æŸ¥CORSé…ç½®
            </div>
        </div>

        <div style="text-align: center; margin: 20px 0;">
            <div style="font-size: 24px;">â¬‡ï¸</div>
        </div>

        <div class="flow-container">
            <div class="flow-item allowed">
                <strong>âœ… é…ç½®æ­£ç¡®</strong><br>
                è¿”å›CORSå¤´éƒ¨<br>
                å…è®¸å®é™…è¯·æ±‚
            </div>
            <div style="font-size: 24px;">VS</div>
            <div class="flow-item blocked">
                <strong>âŒ é…ç½®é”™è¯¯</strong><br>
                æ— CORSå¤´éƒ¨<br>
                æµè§ˆå™¨é˜»æ­¢è¯·æ±‚
            </div>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ® äº¤äº’å¼æ¼”ç¤º</h2>
        
        <div class="interactive-demo">
            <h3>æ¨¡æ‹Ÿä¸åŒçš„CORSåœºæ™¯</h3>
            <p>ç‚¹å‡»æŒ‰é’®ä½“éªŒä¸åŒçš„CORSé…ç½®ç»“æœï¼š</p>
            
            <button onclick="simulateSuccess()" class="success-btn">âœ… æ¨¡æ‹ŸCORSæˆåŠŸ</button>
            <button onclick="simulateError()" class="error-btn">âŒ æ¨¡æ‹ŸCORSé”™è¯¯</button>
            <button onclick="simulateProxy()">ğŸ”„ æ¨¡æ‹Ÿä»£ç†è§£å†³</button>
            
            <div id="demoResult"></div>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ’¡ å…³é”®ç†è§£ç‚¹</h2>
        
        <div class="step">
            <h3>ğŸ›¡ï¸ CORSæ˜¯æµè§ˆå™¨çš„å®‰å…¨æœºåˆ¶</h3>
            <p>ä¸æ˜¯æœåŠ¡å™¨é”™è¯¯ï¼Œè€Œæ˜¯æµè§ˆå™¨ä¿æŠ¤ç”¨æˆ·çš„å®‰å…¨åŠŸèƒ½</p>
        </div>

        <div class="step">
            <h3>ğŸ” é”™è¯¯å‘ç”Ÿåœ¨å®¢æˆ·ç«¯</h3>
            <p>è¯·æ±‚å®é™…ä¸Šåˆ°è¾¾äº†æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¹Ÿæ­£å¸¸å“åº”äº†ï¼Œä½†æµè§ˆå™¨é˜»æ­¢äº†JavaScriptè®¿é—®å“åº”</p>
        </div>

        <div class="step">
            <h3>ğŸ”§ éœ€è¦æœåŠ¡å™¨æ˜ç¡®å…è®¸</h3>
            <p>æœåŠ¡å™¨å¿…é¡»é€šè¿‡å“åº”å¤´æ˜ç¡®è¯´ï¼š"æˆ‘å…è®¸è¿™ä¸ªåŸŸåè®¿é—®æˆ‘çš„èµ„æº"</p>
        </div>

        <div class="step">
            <h3>ğŸš« ç›´æ¥è®¿é—®URLä¸ä¼šæœ‰CORSé”™è¯¯</h3>
            <p>åœ¨åœ°å€æ ç›´æ¥è®¿é—®API URLæ˜¯å¯ä»¥çš„ï¼ŒCORSåªå½±å“JavaScriptçš„è·¨åŸŸè¯·æ±‚</p>
        </div>
    </div>

    <script>
        function simulateSuccess() {
            const result = document.getElementById('demoResult');
            result.className = 'step success';
            result.innerHTML = `
                <h4>âœ… CORSæˆåŠŸæµç¨‹</h4>
                <div class="code">
1. æµè§ˆå™¨å‘é€é¢„æ£€è¯·æ±‚ï¼šOPTIONS /health
2. æœåŠ¡å™¨å“åº”ï¼šAccess-Control-Allow-Origin: https://frontend.vercel.app
3. æµè§ˆå™¨ï¼š"å¥½çš„ï¼Œå…è®¸è®¿é—®"
4. å‘é€å®é™…è¯·æ±‚ï¼šGET /health
5. è·å–æ•°æ®ï¼š{"status": "healthy"}
                </div>
                <p><strong>ç»“æœï¼š</strong> ğŸ‰ è¯·æ±‚æˆåŠŸï¼Œæ•°æ®æ­£å¸¸æ˜¾ç¤º</p>
            `;
        }

        function simulateError() {
            const result = document.getElementById('demoResult');
            result.className = 'step error';
            result.innerHTML = `
                <h4>âŒ CORSé”™è¯¯æµç¨‹</h4>
                <div class="code">
1. æµè§ˆå™¨å‘é€é¢„æ£€è¯·æ±‚ï¼šOPTIONS /health
2. æœåŠ¡å™¨å“åº”ï¼š200 OK (ä½†æ²¡æœ‰CORSå¤´éƒ¨)
3. æµè§ˆå™¨ï¼š"æœåŠ¡å™¨æ²¡æœ‰æ˜ç¡®å…è®¸ï¼Œæ‹’ç»è®¿é—®"
4. æ˜¾ç¤ºé”™è¯¯ï¼šCORS policy blocked
5. JavaScriptæ— æ³•è·å–æ•°æ®
                </div>
                <p><strong>ç»“æœï¼š</strong> ğŸš¨ è¯·æ±‚è¢«é˜»æ­¢ï¼Œæ§åˆ¶å°æ˜¾ç¤ºCORSé”™è¯¯</p>
            `;
        }

        function simulateProxy() {
            const result = document.getElementById('demoResult');
            result.className = 'step';
            result.innerHTML = `
                <h4>ğŸ”„ ä»£ç†è§£å†³æ–¹æ¡ˆ</h4>
                <div class="code">
1. å‰ç«¯è¯·æ±‚ï¼šcors-anywhere.herokuapp.com/backend.vercel.app/health
2. ä»£ç†æœåŠ¡å™¨ï¼šæ¥æ”¶è¯·æ±‚ï¼Œè½¬å‘ç»™çœŸæ­£çš„åç«¯
3. åç«¯ï¼šæ­£å¸¸å“åº”æ•°æ®ç»™ä»£ç†æœåŠ¡å™¨
4. ä»£ç†æœåŠ¡å™¨ï¼šæ·»åŠ CORSå¤´éƒ¨ï¼Œè¿”å›ç»™å‰ç«¯
5. æµè§ˆå™¨ï¼š"ä»£ç†æœåŠ¡å™¨å…è®¸äº†ï¼ŒOK"
                </div>
                <p><strong>ç»“æœï¼š</strong> ğŸ¯ ç»•è¿‡CORSé™åˆ¶ï¼ŒæˆåŠŸè·å–æ•°æ®</p>
                <p><strong>æ³¨æ„ï¼š</strong> è¿™æ˜¯ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼Œæœ€å¥½è¿˜æ˜¯ä¿®å¤åç«¯CORSé…ç½®</p>
            `;
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºåˆå§‹è¯´æ˜
        window.onload = function() {
            const result = document.getElementById('demoResult');
            result.innerHTML = `
                <p>ğŸ‘† ç‚¹å‡»ä¸Šé¢çš„æŒ‰é’®æŸ¥çœ‹ä¸åŒCORSåœºæ™¯çš„æ¨¡æ‹Ÿæ¼”ç¤º</p>
            `;
        };
    </script>
</body>
</html> 